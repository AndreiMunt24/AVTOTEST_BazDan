Страны

Инструкция по использованию платформы



В каких странах проживают наши клиенты.
Используйте таблицу gb_shop.Customers.
Сколько уникальных стран вы получили в ответе?

-- Вы работаете с PostgreSQL
-- Введите свой код ниже
SELECT COUNT(DISTINCT country) AS unique_countries
FROM gb_shop.Customers;
***


Argentina

Инструкция по использованию платформы



Сколько клиентов проживает в Argentina? Используйте таблицу gb_shop.Customers.


-- Вы работаете с PostgreSQL
-- Введите свой код ниже
SELECT COUNT(*) AS number_of_customers
FROM gb_shop.Customers
WHERE country = 'Argentina';
***


Средняя цена и количество товаров

Инструкция по использованию платформы



Посчитайте среднюю цену и количество товаров в 8 категории.
Используйте таблицу gb_shop.Products.

-- Вы работаете с PostgreSQL
-- Введите свой код ниже
SELECT 
    AVG(price) AS average_price,
    COUNT(*) AS number_of_products
FROM gb_shop.Products
WHERE categoryid = 8;
****


Средний возраст работников

Инструкция по использованию платформы



Посчитайте средний возраст работников на дату 2023-09-09.
Используйте таблицу gb_shop.Employees.

Давайте разберем подробнее, как это будет написано в PostgreSQL.

AGE('2023-09-09', TO_DATE(birthdate, 'YYYY-MM-DD')): Эта функция вычисляет интервал между двумя датами - указанной датой '2023-09-09' и датой рождения сотрудника, преобразованной из строки в формат даты с помощью функции TO_DATE. Полученный интервал представляет собой разницу во времени между двумя датами.

EXTRACT(YEAR FROM ...): Эта функция извлекает количество лет из интервала времени, возвращаемого функцией AGE. В нашем случае она извлекает только количество лет из интервала возраста сотрудников.



-- Вы работаете с PostgreSQL
-- Введите свой код ниже

SELECT AVG(EXTRACT(YEAR FROM AGE('2023-09-09', TO_DATE(birthdate, 'YYYY-MM-DD')))) AS average_age
FROM gb_shop.Employees;
*****

Заказы

Инструкция по использованию платформы



Вам необходимо получить заказы, которые сделаны в течении 35 дней до даты 2023-10-10 (то есть с 5 сентября до 10 октября включительно).
В Mssql вы бы использовали функцию DATEDIFF, для определения переменных для даты и диапазона.
Отсортируйте по дате заказа.
Используйте таблицу gb_shop.Orders.

Но в этой системе мы напишем запрос на PostgreSQL.
Разница между запросами на PostgreSQL и MSSQL заключается в использовании разных функций и операторов для работы с датами.

Давайте разберем каждую часть запроса для MSSQL:

DATEDIFF(day, orderdate, '2023-10-10'): Эта функция вычисляет разницу между двумя датами в указанных единицах измерения (в данном случае, в днях). Она отличается от оператора BETWEEN в том, что она возвращает разницу между двумя датами, а не фактические даты в заданном диапазоне.

BETWEEN 0 AND 35: Это оператор BETWEEN, который используется для проверки, находится ли значение (в данном случае, разница в днях) между указанными значениями (0 и 35).

Теперь давайте перепишем этот запрос для PostgreSQL, используя соответствующие функции:

CAST(orderdate AS date): Функция CAST используется для преобразования значения одного типа данных в другой. В данном случае, она преобразует значение столбца orderdate, которое, вероятно, хранится как строка или в другом формате, в тип данных date.
Пример: CAST('2023-10-10' AS date) преобразует строку '2023-10-10' в тип данных date.

BETWEEN: Оператор BETWEEN используется для проверки, находится ли значение в заданном диапазоне. Он возвращает TRUE, если значение находится в диапазоне, и FALSE в противном случае.
Пример: SELECT * FROM table WHERE column BETWEEN 10 AND 20.

INTERVAL: Оператор INTERVAL используется для добавления или вычитания интервала времени из даты или времени. Он позволяет добавлять или вычитать дни, часы, минуты и т. д.
Пример: DATE '2023-10-10' - INTERVAL '35 days' вычитает 35 дней из даты 2023-10-10.

Для того, чтобы решить задачу:

Преобразуйте orderdate к типу date с помощью CAST.
Затем используйте BETWEEN для проверки, находится ли преобразованная дата в указанном диапазоне.
Также используйте INTERVAL для вычитания 35 дней из даты '2023-10-10'.
Результаты запроса упорядочьте по дате заказа.



-- Вы работаете с PostgreSQL
-- Введите свой код ниже

SELECT *
FROM gb_shop.Orders
WHERE CAST(orderdate AS date) BETWEEN DATE '2023-09-05' AND DATE '2023-10-10'
ORDER BY orderdate;


***


Количество заказов за сентябрь 3

Инструкция по использованию платформы



Вам необходимо получить количество заказов за сентябрь месяц 2023 года (с помощью сравнения начальной и конечной даты).
Используйте таблицу gb_shop.Orders.


-- Вы работаете с PostgreSQL
-- Введите свой код ниже

SELECT COUNT(*) AS number_of_orders
FROM gb_shop.Orders
WHERE CAST(orderdate AS date) BETWEEN DATE '2023-09-01' AND DATE '2023-09-30';


****




Количество заказов за сентябрь 1

Инструкция по использованию платформы



Вам необходимо получить количество заказов за сентябрь месяц 2023 года (с помощьюLIKE).
Используйте таблицу gb_shop.Orders.




-- Вы работаете с PostgreSQL
-- Введите свой код ниже

SELECT COUNT(*) AS number_of_orders
FROM gb_shop.Orders
WHERE TO_CHAR(CAST(orderdate AS date), 'YYYY-MM') LIKE '2023-09';


****



Количество заказов за сентябрь 2

Инструкция по использованию платформы



Вам необходимо получить количество заказов за сентябрь месяц 2023 года (с помощью YEAR и MONTH и сравнение начальной и конечной даты).
Используйте таблицу gb_shop.Orders.

Давайте разберем подробнее, как это будет написано в PostgreSQL.

CAST: CAST - это функция в SQL, которая преобразует значение одного типа данных в другой. В контексте даты мы используем CAST для преобразования строкового типа данных (например, character varying) в тип данных даты (например, DATE). Например:


SELECT CAST('2023-07-04' AS DATE);
Результат будет дата 2023-07-04.

EXTRACT: EXTRACT - это функция, используемая для извлечения части даты или времени (например, месяца, дня, года) из значения даты или времени. Например:


SELECT EXTRACT(MONTH FROM '2023-07-04' AS DATE);
Результат будет 7, так как мы извлекаем месяц из даты 2023-07-04.

Этот же запрос в MsSql выглядел бы так:


SELECT MONTH('2023-07-04');




-- Вы работаете с PostgreSQL
-- Введите свой код ниже

SELECT COUNT(*) AS number_of_orders
FROM gb_shop.Orders
WHERE EXTRACT(YEAR FROM CAST(orderdate AS date)) = 2023
  AND EXTRACT(MONTH FROM CAST(orderdate AS date)) = 9;


  %%%%%